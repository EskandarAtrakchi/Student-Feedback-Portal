<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title><%= title %></title>
  </head>
  <body>
    <header>
      <h1>Student Feedback Portal</h1>
      <nav>
        <a href="/">Home</a> |
        <a href="/posts">Posts</a> |
        <a href="/search">Search</a> |
        <% if (currentUser) { %>
          <a href="/logout">Logout</a>
        <% } else { %>
          <a href="/register">Register</a> |
          <a href="/login">Login</a>
        <% } %>
      </nav>
      <hr />
    </header>

    <main>
      <h2>Search Posts</h2>

      <form method="get" action="/search">
        <input type="text" name="q" value="<%= q %>" placeholder="Search..." />
        <button type="submit">Search</button>
      </form>

      <% if (q) { %>
        <!-- INSECURE: reflected XSS via raw HTML -->
        <p>You searched for: <%- q %></p>
      <% } %>

      <% if (results && results.length > 0) { %>
        <h3>Results</h3>
        <ul>
          <% results.forEach(post => { %>
            <li>
              <a href="/posts/<%= post.id %>"><%- post.title %></a>
            </li>
          <% }); %>
        </ul>
      <% } else if (q) { %>
        <p>No results found.</p>
      <% } %>
    </main>
  </body>
</html>
